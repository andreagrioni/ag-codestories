<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrea Grioni">
<meta name="dcterms.date" content="2023-09-04">

<title>SomaScan - A Powerful Tool for Proteomics Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="AG001_somascan_intro_files/libs/clipboard/clipboard.min.js"></script>
<script src="AG001_somascan_intro_files/libs/quarto-html/quarto.js"></script>
<script src="AG001_somascan_intro_files/libs/quarto-html/popper.min.js"></script>
<script src="AG001_somascan_intro_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AG001_somascan_intro_files/libs/quarto-html/anchor.min.js"></script>
<link href="AG001_somascan_intro_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AG001_somascan_intro_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AG001_somascan_intro_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AG001_somascan_intro_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AG001_somascan_intro_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SomaScan - A Powerful Tool for Proteomics Analysis</h1>
<p class="subtitle lead">The Power of Data to Understand Proteins</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrea Grioni </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 4, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<p><img src="img/ag001_img002.png" class="img-fluid"></p>
<section id="exploring-health-how-somascan-uncovers-secrets-of-proteins" class="level2">
<h2 class="anchored" data-anchor-id="exploring-health-how-somascan-uncovers-secrets-of-proteins">Exploring Health: How SomaScan Uncovers Secrets of&nbsp;Proteins</h2>
<p>Imagine SomaScan as a super advanced tool that helps scientists understand how our bodies work at a tiny level. Inside our bodies, there are tiny molecules called proteins that do important jobs like keeping us healthy and making sure our bodies function properly. SomaScan, created by a company called <a href="https://somalogic.com">SomaLogic</a>, is like a super microscope for these proteins. It can look at thousands of them all at once and tell scientists how many of them are there. This is a significant advancement because in the past, scientists could only study a few proteins at a time.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ag001_img001.png" style="width:20.0%;height:20.0%" alt="lock &amp; key mechanism" class="figure-img"></p>
</figure>
</div>
<p>SomaScan works a bit like a lock and key. It uses tiny pieces of DNA or RNA, which are like special keys that fit perfectly with specific proteins. When these keys find the right proteins, they stick to them, and that’s how SomaScan can measure what’s happening. This technology is incredibly useful. It can help researchers learn more about diseases, discover new medicines, and even figure out the best treatments for each person based on their unique proteins. SomaScan acts as an incredible tool that aids scientists in exploring the intricate world of proteins and their impact on our health.</p>
</section>
<section id="objective" class="level2">
<h2 class="anchored" data-anchor-id="objective">Objective</h2>
<p>In the realm of SomaScan data analysis, a common and pivotal question arises: Can we identify proteins that exhibit differential abundance between two distinct groups?</p>
<p>To fully appreciate the significance of this question, let’s first delve into the broader concept of molecular biomarkers. Molecular biomarkers are measurable indicators found within biological samples that offer valuable insights into an individual’s health status or the presence of a disease. These indicators span a spectrum of entities, including molecules like proteins, metabolites, cellular characteristics, and genetic variations. In modern medicine, biomarkers serve as essential tools, aiding in tasks such as diagnosing conditions, predicting disease outcomes, monitoring health trends, and assessing the efficacy of treatments.</p>
</section>
<section id="covidome-project-dataset" class="level2">
<h2 class="anchored" data-anchor-id="covidome-project-dataset">COVIDome Project Dataset</h2>
<p>There are three datasets in this entry: the COVIDOme Sample Metadata, the COVIDome SomaScan dataset, and the COVIDome MSD Cytokine Dataset. These datasets were generated by the COVIDome Project at the University of Colorado Anschutz Medical Campus. To learn more about the COVIDome Project please visit covidome.org. This project aims to accelerate translational research in the field of COVID19 by generating and broadly sharing multi-omics datasets of research participants with and without COVID19.</p>
<p>The Sample Metadata file describes sample ID, COVID19 status at the time of blood draw (positive or negative), sex and age. The SomaScan dataset is a plasma proteomics dataset obtained from research participants with and without COVID19 using the SomaScan® technology. The MSD cytokine dataset was generated using multiplex immunoassays with Meso Scale Discovery (MSD) technology.</p>
<p>Link to dataset <a href="https://data.mendeley.com/datasets/2mc6rrc5j3/2">here</a> | Link to publication <a href="https://doi.org/10.1016/j.celrep.2021.109527">here</a> | link to the interactive db <a href="https://covidome.shinyapps.io/Proteome/">here</a></p>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<p>Linear regression serves as the most prevalent technique for pinpointing proteins that exhibit differential quantification between two distinct groups. Its popularity is attributed to its speed, high interpretability, and its capacity to accommodate the analysis’s need for accounting independent covariates such as sex and age.</p>
<p>In the following sections, I will present two distinct strategies for analysis: hypothesis testing and hypothesis generation.</p>
<p>In Example 1, a hypothesis-testing approach is demonstrated, aiming to validate the author’s assertion of the upregulation of the MX1 protein in COVID-19 patients.</p>
<p>In Example 2, a hypothesis-generation approach is showcased. Here, the objective is to uncover all proteins that showcase varying abundance levels between COVID-19 negative and COVID-19 positive groups.</p>
<section id="load-libraries" class="level3">
<h3 class="anchored" data-anchor-id="load-libraries">load libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load data</h3>
<p>Load SomaScan dataset and metadata.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load meta</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/SomaScan/COVIDome_metadata.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load SomaScan</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>SomaScan <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/SomaScan/COVIDome_dataset.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(SomaScan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4843  103</code></pre>
</div>
</div>
</section>
<section id="data-transformation-and-normalization" class="level3">
<h3 class="anchored" data-anchor-id="data-transformation-and-normalization">Data Transformation and Normalization</h3>
<section id="metadata" class="level4">
<h4 class="anchored" data-anchor-id="metadata">Metadata</h4>
<p>Remove empty column <code>...5</code>, remove samples with unknown real age (label <code>under 20</code>) and make <code>Age</code> column numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific columns</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>metadata_clean <span class="ot">&lt;-</span> metadata[, <span class="fu">c</span>(<span class="st">"RecordID"</span>, <span class="st">"COVID_status"</span>, <span class="st">"Sex"</span>, <span class="st">"Age"</span>)]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out rows where Age is "under 20"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>metadata_clean <span class="ot">&lt;-</span> metadata_clean[metadata_clean<span class="sc">$</span>Age <span class="sc">!=</span> <span class="st">"under 20"</span>, ]</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Age to numeric</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>metadata_clean<span class="sc">$</span>Age <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(metadata_clean<span class="sc">$</span>Age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="somascan" class="level4">
<h4 class="anchored" data-anchor-id="somascan">SomaScan</h4>
<p>Pivot samples columns into long format, with sample’s names under column <code>SUBJID</code> and measurements under column <code>RFU</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>SomaScan_pivot <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    SomaScan,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">!</span><span class="fu">c</span>(<span class="st">"AptName"</span>, <span class="st">"Analyte"</span>, <span class="st">"EntrezGeneSymbol"</span>, <span class="st">"UniProt"</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"SUBJID"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"RFU"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="normalize-data" class="level4">
<h4 class="anchored" data-anchor-id="normalize-data">Normalize data</h4>
<p>The log2 transformation is a commonly used technique in data analysis, including proteomics, for several reasons. One key benefit is its ability to help approximate a Gaussian (normal) distribution for data that might be skewed or have a wide range of values. In many statistical analyses, assumptions of normality are important for accurate results. Applying the log2 transformation can make the data more symmetric and align it closer to a normal distribution, which is particularly useful for techniques that assume normally distributed data. Additionally, the log2 transformation helps in stabilizing the variability across data points, enhancing the reliability of subsequent statistical analyses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>SomaScan_norm <span class="ot">&lt;-</span> SomaScan_pivot <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">norm =</span> <span class="fu">log2</span>(RFU)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Show distribution before and after normalization.</p>
<div class="cell">

</div>
<div id="fig-hist" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-raw" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/ag001_img003.png" class="img-fluid figure-img" data-ref-parent="fig-hist"></p>
<p></p><figcaption class="figure-caption">(a) COVID negative</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-norm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/ag001_img004.png" class="img-fluid figure-img" data-ref-parent="fig-hist"></p>
<p></p><figcaption class="figure-caption">(b) COVID positive</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: pre and post normalization</figcaption><p></p>
</figure>
</div>
</section>
<section id="pivot-features-in-long-table-format." class="level4">
<h4 class="anchored" data-anchor-id="pivot-features-in-long-table-format.">Pivot features in long table format.</h4>
<p>Create a new table where each rows correspond to <code>SUBJID</code> and our features / proteins are columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>placeholder <span class="ot">&lt;-</span> SomaScan_norm <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        SUBJID, AptName, norm</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_from =</span> <span class="st">"AptName"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_from =</span> <span class="st">"norm"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combine-somascan-and-metadata" class="level4">
<h4 class="anchored" data-anchor-id="combine-somascan-and-metadata">Combine SomaScan and metadata</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>working_table <span class="ot">&lt;-</span> placeholder <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        metadata_clean,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"SUBJID"</span> <span class="ot">=</span> <span class="st">"RecordID"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="example-1-hypotesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="example-1-hypotesis-testing">Example 1 | Hypotesis Testing</h3>
<p>In this example, the publication indicate the protein <code>MX1</code> to be highly expressed in the COVID posive group. The linear model will use the protein <code>MX1</code> as an exmple of the analysis.</p>
<section id="data-preparation" class="level4">
<h4 class="anchored" data-anchor-id="data-preparation">data preparation</h4>
<p>Select the column <code>MX1.17460.51</code> which contains the normalize RFU values for the protein <code>MX1</code>, and rename it <code>MX1</code>. Also, the <code>example_1</code> dataframe will include the independent variables <code>COVID_status</code> and covariates <code>Sex</code> and <code>Age</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>example_1 <span class="ot">&lt;-</span> working_table <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="co"># select the dependent variable</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># and rename it MX1 column</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">MX1 =</span> MX1.<span class="fl">17460.51</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># select indepedent variables</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">all_of</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">c</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">"COVID_status"</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Sex"</span>, </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Age"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use the R function <code>stats::lm</code> to create the linear regression model. This model will use the formula <code>MX1 ~ COVID_status + Sex + Age</code>, which predict the abundance of <code>MX1</code> protein based on the COVID status (negative or positive) while adjusting for Sex and Age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example linear regression</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(MX1 <span class="sc">~</span> COVID_status <span class="sc">+</span> Sex <span class="sc">+</span> Age, <span class="at">data =</span> example_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The anova() function in R is used to assess the statistical significance of individual predictor variables in a linear regression model, comparing models with and without specific variables to determine their contribution to explaining the variation in the dependent variable. The result of the anova test shows that the independent variable <code>COVID_status</code> has an effect in predicting the <code>MX1</code> protein aboundance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show summary of the model</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: MX1
             Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
COVID_status  1 227.884 227.884 67.2399 3.553e-12 ***
Sex           1   0.082   0.082  0.0243    0.8765    
Age           1   0.500   0.500  0.1476    0.7018    
Residuals    79 267.740   3.389                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Generate the distribution of <code>MX1</code> protein between the COVID negative and positive groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data by treatment groups</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>group1_values <span class="ot">&lt;-</span> example_1<span class="sc">$</span>MX1[example_1<span class="sc">$</span>COVID_status <span class="sc">==</span> <span class="st">"Negative"</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>group2_values <span class="ot">&lt;-</span> example_1<span class="sc">$</span>MX1[example_1<span class="sc">$</span>COVID_status <span class="sc">==</span> <span class="st">"Positive"</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create separate histograms</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"img/ag001_img005.png"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    group1_values, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">"Histogram of MX1 Protein Values - COVID negative group"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">"Protein Values"</span>, </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">"green"</span>, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">min</span>(example_1<span class="sc">$</span>MX1), </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(example_1<span class="sc">$</span>MX1)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">dev.off</span>())</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">"img/ag001_img006.png"</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    group2_values,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">"Histogram of MX1 Protein Values - COVID positive group"</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">"Protein Values"</span>, </span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="st">"red"</span>, </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim=</span><span class="fu">c</span>(</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        <span class="fu">min</span>(example_1<span class="sc">$</span>MX1), </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        <span class="fu">max</span>(example_1<span class="sc">$</span>MX1))</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">dev.off</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-MX1" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-negative" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/ag001_img005.png" class="img-fluid figure-img" data-ref-parent="fig-MX1"></p>
<p></p><figcaption class="figure-caption">(a) COVID negative</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-positive" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/ag001_img006.png" class="img-fluid figure-img" data-ref-parent="fig-MX1"></p>
<p></p><figcaption class="figure-caption">(b) COVID positive</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: MX1 distribution by group</figcaption><p></p>
</figure>
</div>
</section>
</section>
<section id="example-2-hypotesis-generation" class="level3">
<h3 class="anchored" data-anchor-id="example-2-hypotesis-generation">Example 2 | Hypotesis Generation</h3>
<p>In this case, a linear regression model is fitted for each protein.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the unique number of proteins</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>protein_models <span class="ot">&lt;-</span> SomaScan_norm<span class="sc">$</span>AptName <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calc statistics</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>covid_p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(protein_models, <span class="cf">function</span>(aptname) {</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    formula <span class="ot">=</span> <span class="fu">paste0</span>(aptname, <span class="st">" ~ COVID_status + Sex + Age"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.formula</span>(formula), <span class="at">data =</span> working_table)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(model)<span class="sc">$</span>coefficients[<span class="st">"COVID_statusPositive"</span>, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Considering that we are running thousands of models, it is necessary to adjust the p-value for multiple tests. In this case, a common adjstment method is the Benjamini and Hochberg, which is commonly known as False Discovery Rate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>covid_fdr <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(covid_p_values, <span class="at">method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Create a final dataframe containing pvalue and FDR for all models. The column <code>candadite</code> stored the statistical significan flag considering the common threshold of 0.05.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Protein =</span> protein_models,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">P_Value =</span> covid_p_values,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FDR =</span> covid_fdr,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">candidate =</span> <span class="fu">ifelse</span>(FDR <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The analysis identified a total of 465 proteins that are quantitatively different with statistical significance between COVID positive and COVID negative groups.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In conclusion, this post serves as a window into the world of protein biomarkers and a remarkable technology called SomaScan. By exploring the role of linear regression in analyzing SomaScan data, we’ve touched on two distinct strategies: hypothesis generation and testing. This glimpse offers an example of the work of data scientists, bioinformaticians, and computational biologists within pharmaceutical companies. The journey into the realm of proteins and data holds immense promise, contributing to advancements in healthcare and personalized treatments.</p>
</section>
<section id="contact" class="level2">
<h2 class="anchored" data-anchor-id="contact">Contact</h2>
<p><a href="https://www.linkedin.com/in/agrioni/">LinkedIn</a></p>
<p><a href="https://andreagrioni.github.io">GitHub Page</a></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>